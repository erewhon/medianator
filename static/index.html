<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Medianator - Media Catalog</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="container">
        <!-- Navigation Bar -->
        <nav class="nav-bar" style="background: white; padding: 15px 30px; border-radius: 15px; margin-bottom: 30px; box-shadow: 0 2px 10px rgba(0,0,0,0.1); display: flex; gap: 20px; align-items: center;">
            <a href="/" class="nav-link" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; text-decoration: none; padding: 8px 16px; border-radius: 20px;">üì∏ Gallery</a>
            <a href="/stories.html" class="nav-link" style="color: #666; text-decoration: none; padding: 8px 16px; border-radius: 20px; transition: background 0.3s;">üìö Stories</a>
        </nav>
        
        <header>
            <h1>üì∏ Medianator</h1>
            <p>Media Catalog Engine</p>
        </header>

        <!-- Stats Dashboard -->
        <section class="stats-section">
            <h2>üìä Statistics</h2>
            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-value" id="total-files">-</div>
                    <div class="stat-label">Total Files</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value" id="image-files">-</div>
                    <div class="stat-label">Images</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value" id="video-files">-</div>
                    <div class="stat-label">Videos</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value" id="audio-files">-</div>
                    <div class="stat-label">Audio</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value" id="total-size">-</div>
                    <div class="stat-label">Total Size</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value" id="duplicate-groups">-</div>
                    <div class="stat-label">Duplicate Groups</div>
                </div>
            </div>
        </section>

        <!-- Upload Section -->
        <section class="upload-section">
            <h2>üì§ Upload Files</h2>
            <div class="upload-area" id="upload-area">
                <input type="file" id="file-input" multiple accept="image/*,video/*,audio/*" hidden>
                <p>üìÅ Drop files here or click to browse</p>
                <p class="upload-hint">Supports images, videos, and audio files</p>
            </div>
            <div id="upload-progress" class="upload-progress hidden">
                <div class="progress-bar">
                    <div class="progress-fill" id="progress-fill"></div>
                </div>
                <p id="upload-status"></p>
            </div>
        </section>

        <!-- Search Section -->
        <section class="search-section">
            <h2>üîç Search Media</h2>
            <div class="search-bar">
                <input type="text" id="search-input" placeholder="Search by filename or path...">
                <button id="search-btn">Search</button>
                <select id="filter-type">
                    <option value="">All Types</option>
                    <option value="image">Images</option>
                    <option value="video">Videos</option>
                    <option value="audio">Audio</option>
                </select>
            </div>
        </section>

        <!-- Gallery Section -->
        <section class="gallery-section">
            <h2>üñºÔ∏è Media Gallery</h2>
            <div class="view-controls">
                <button class="view-btn active" data-view="grid">Grid View</button>
                <button class="view-btn" data-view="list">List View</button>
                <button id="scan-btn" class="action-btn">üîÑ Scan Directory</button>
                <button id="duplicates-btn" class="action-btn">üîç Find Duplicates</button>
                <button id="archive-duplicates-btn" class="action-btn hidden">üì¶ Archive Duplicates</button>
                <button id="batch-reprocess-btn" class="action-btn">‚ôæÔ∏è Batch Reprocess</button>
                <button id="view-faces-btn" class="action-btn">üë§ View Faces</button>
                <button id="auto-albums-btn" class="action-btn">üì∏ Auto Albums</button>
            </div>
            <div id="gallery" class="gallery grid-view">
                <!-- Media items will be loaded here -->
            </div>
            <div class="pagination">
                <button id="prev-page" disabled>Previous</button>
                <span id="page-info">Page 1 of 1</span>
                <button id="next-page">Next</button>
            </div>
        </section>

        <!-- Scan Modal -->
        <div id="scan-modal" class="modal hidden">
            <div class="modal-content">
                <span class="close">&times;</span>
                <h2>Scan Directory</h2>
                <input type="text" id="scan-path" placeholder="Enter directory path to scan">
                <button id="start-scan">Start Scan</button>
                <div id="scan-results" class="scan-results hidden">
                    <p id="scan-status"></p>
                    <div class="progress-bar">
                        <div class="progress-fill" id="scan-progress"></div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Media Detail Slide Panel -->
        <div id="media-panel" class="slide-panel">
            <div class="panel-header">
                <h3 id="media-filename"></h3>
                <button class="panel-close" id="close-panel">&times;</button>
            </div>
            <div class="panel-content">
                <div class="media-viewer">
                    <img id="media-preview" src="" alt="Media preview">
                    <video id="video-preview" controls hidden></video>
                    <audio id="audio-preview" controls hidden></audio>
                </div>
                
                <div class="media-info">
                    <div id="parent-image-info" class="parent-image-info hidden">
                        <h4>üìé Part of larger image</h4>
                        <div class="parent-link">
                            <a href="#" id="parent-image-link" class="parent-image-link">
                                <img id="parent-thumbnail" src="" alt="Parent image" class="parent-thumbnail">
                                <span id="parent-filename"></span>
                            </a>
                        </div>
                    </div>
                    
                    <!-- Edit Media Info -->
                    <div class="edit-media-info">
                        <h4>‚úèÔ∏è Edit Information</h4>
                        <div class="form-group">
                            <label for="media-user-description">Description</label>
                            <textarea id="media-user-description" rows="3" placeholder="Add your description..."></textarea>
                        </div>
                        <div class="form-group">
                            <label for="media-user-tags">Tags (comma-separated)</label>
                            <input type="text" id="media-user-tags" placeholder="vacation, family, 2024">
                        </div>
                        <button id="save-media-info-btn" class="primary-btn">Save Changes</button>
                    </div>
                    
                    <!-- Conversion Controls -->
                    <div class="conversion-controls">
                        <h4>üîÑ Convert & Download</h4>
                        <div id="image-conversion" class="conversion-section hidden">
                            <label for="image-format">Convert to:</label>
                            <select id="image-format">
                                <option value="">Select format</option>
                                <option value="jpeg">JPEG</option>
                                <option value="png">PNG</option>
                                <option value="webp">WebP</option>
                                <option value="gif">GIF</option>
                                <option value="bmp">BMP</option>
                                <option value="tiff">TIFF</option>
                            </select>
                            <div class="conversion-options">
                                <label for="image-quality">Quality (1-100):</label>
                                <input type="number" id="image-quality" min="1" max="100" value="85">
                            </div>
                            <button id="convert-image-btn" class="convert-btn">Convert Image</button>
                        </div>
                        
                        <div id="video-conversion" class="conversion-section hidden">
                            <label for="video-format">Convert to:</label>
                            <select id="video-format">
                                <option value="">Select format</option>
                                <option value="mp4">MP4 (H.264)</option>
                                <option value="webm">WebM</option>
                                <option value="avi">AVI</option>
                                <option value="mov">MOV</option>
                                <option value="mkv">MKV</option>
                                <option value="gif">GIF (animated)</option>
                            </select>
                            <div class="conversion-options">
                                <label for="video-resolution">Resolution:</label>
                                <select id="video-resolution">
                                    <option value="">Keep original</option>
                                    <option value="1920x1080">1080p (1920x1080)</option>
                                    <option value="1280x720">720p (1280x720)</option>
                                    <option value="854x480">480p (854x480)</option>
                                    <option value="640x360">360p (640x360)</option>
                                </select>
                            </div>
                            <button id="convert-video-btn" class="convert-btn">Convert Video</button>
                        </div>
                        
                        <div id="audio-conversion" class="conversion-section hidden">
                            <label for="audio-format">Convert to:</label>
                            <select id="audio-format">
                                <option value="">Select format</option>
                                <option value="mp3">MP3</option>
                                <option value="wav">WAV</option>
                                <option value="ogg">OGG Vorbis</option>
                                <option value="m4a">M4A (AAC)</option>
                                <option value="flac">FLAC</option>
                            </select>
                            <div class="conversion-options">
                                <label for="audio-bitrate">Bitrate:</label>
                                <select id="audio-bitrate">
                                    <option value="128">128 kbps</option>
                                    <option value="192">192 kbps</option>
                                    <option value="256" selected>256 kbps</option>
                                    <option value="320">320 kbps</option>
                                </select>
                            </div>
                            <button id="convert-audio-btn" class="convert-btn">Convert Audio</button>
                        </div>
                        
                        <div id="conversion-progress" class="conversion-progress hidden">
                            <div class="progress-bar">
                                <div class="progress-fill" id="conversion-progress-fill"></div>
                            </div>
                            <p id="conversion-status">Converting...</p>
                        </div>
                    </div>
                    
                    <div class="info-grid">
                        <div class="info-item">
                            <span class="info-label">Path:</span>
                            <span id="media-path"></span>
                        </div>
                        <div class="info-item">
                            <span class="info-label">Size:</span>
                            <span id="media-size"></span>
                        </div>
                        <div class="info-item">
                            <span class="info-label">Type:</span>
                            <span id="media-type"></span>
                        </div>
                        <div class="info-item">
                            <span class="info-label">Dimensions:</span>
                            <span id="media-dimensions"></span>
                        </div>
                        <div class="info-item">
                            <span class="info-label">Hash:</span>
                            <span id="media-hash" class="hash"></span>
                        </div>
                        <div class="info-item">
                            <span class="info-label">Created:</span>
                            <span id="media-created"></span>
                        </div>
                    </div>
                    
                    <div class="camera-info hidden" id="camera-info">
                        <h4>üì∑ Camera Information</h4>
                        <div class="info-grid">
                            <div class="info-item">
                                <span class="info-label">Camera:</span>
                                <span id="camera-make"></span>
                            </div>
                            <div class="info-item">
                                <span class="info-label">Model:</span>
                                <span id="camera-model"></span>
                            </div>
                            <div class="info-item">
                                <span class="info-label">ISO:</span>
                                <span id="camera-iso"></span>
                            </div>
                            <div class="info-item">
                                <span class="info-label">Aperture:</span>
                                <span id="camera-aperture"></span>
                            </div>
                        </div>
                    </div>
                    
                    <div class="detected-faces hidden" id="detected-faces">
                        <h4>üë§ Detected Faces</h4>
                        <div id="faces-list"></div>
                    </div>
                    
                    <!-- Transcription Section -->
                    <div class="transcription-section hidden" id="transcription-section">
                        <h4>üéôÔ∏è Transcription</h4>
                        <div id="transcription-controls" class="transcription-controls">
                            <div class="transcription-options">
                                <label for="transcription-language">Language (optional):</label>
                                <select id="transcription-language">
                                    <option value="">Auto-detect</option>
                                    <option value="en">English</option>
                                    <option value="es">Spanish</option>
                                    <option value="fr">French</option>
                                    <option value="de">German</option>
                                    <option value="it">Italian</option>
                                    <option value="pt">Portuguese</option>
                                    <option value="zh">Chinese</option>
                                    <option value="ja">Japanese</option>
                                    <option value="ko">Korean</option>
                                    <option value="ru">Russian</option>
                                </select>
                                <label class="checkbox-label" style="margin-left: 20px;">
                                    <input type="checkbox" id="enable-speaker-diarization">
                                    <span>Identify Multiple Speakers</span>
                                </label>
                            </div>
                            <button id="transcribe-btn" class="primary-btn">Generate Transcription</button>
                        </div>
                        <div id="transcription-progress" class="transcription-progress hidden">
                            <div class="progress-bar">
                                <div class="progress-fill" id="transcription-progress-fill"></div>
                            </div>
                            <p id="transcription-status">Transcribing...</p>
                        </div>
                        <div id="transcription-result" class="transcription-result hidden">
                            <div class="transcription-header">
                                <span id="transcription-language-detected"></span>
                                <button id="delete-transcription-btn" class="small-btn danger">Delete</button>
                            </div>
                            <div id="transcription-text" class="transcription-text"></div>
                            <div id="transcription-segments" class="transcription-segments hidden">
                                <h5>Detailed Segments</h5>
                                <div id="segments-list"></div>
                            </div>
                            <button id="toggle-segments-btn" class="small-btn">Show Detailed Segments</button>
                        </div>
                    </div>
                    
                    <div class="media-actions">
                        <button id="reprocess-single-btn" class="action-btn">üîÑ Reprocess This File</button>
                        <button id="add-to-story-btn" class="action-btn">üìö Add to Story</button>
                    </div>
                </div>
            </div>
        </div>
        <div id="panel-overlay" class="panel-overlay hidden"></div>

        <!-- Duplicates Modal -->
        <div id="duplicates-modal" class="modal hidden">
            <div class="modal-content">
                <span class="close">&times;</span>
                <h2>Duplicate Files</h2>
                <div id="duplicate-stats"></div>
                <div id="duplicate-groups"></div>
                <div class="modal-actions">
                    <button id="archive-selected-duplicates" class="primary-btn">üì¶ Archive Selected Duplicates</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Batch Reprocess Modal -->
    <div id="batch-reprocess-modal" class="modal hidden">
        <div class="modal-content">
            <span class="close" id="close-batch-modal">&times;</span>
            <h2>Batch Reprocess Options</h2>
            <div class="selected-count">
                <p>Selected items: <span id="selected-media-count">0</span></p>
            </div>
            <div class="reprocess-options">
                <label class="checkbox-label">
                    <input type="checkbox" id="reprocess-faces" checked>
                    <span>Reprocess Face Detection</span>
                </label>
                <label class="checkbox-label">
                    <input type="checkbox" id="reprocess-thumbnails" checked>
                    <span>Regenerate Thumbnails</span>
                </label>
                <label class="checkbox-label">
                    <input type="checkbox" id="reprocess-metadata" checked>
                    <span>Update Metadata</span>
                </label>
            </div>
            <div class="modal-actions">
                <button id="start-batch-reprocess" class="primary-btn">Start Reprocessing</button>
                <button id="cancel-batch-reprocess" class="secondary-btn">Cancel</button>
            </div>
        </div>
    </div>

    <!-- Faces View Modal -->
    <div id="faces-modal" class="modal hidden">
        <div class="modal-content large">
            <span class="close" id="close-faces-modal">&times;</span>
            <h2>Face Groups</h2>
            <div id="face-groups-container" class="face-groups-container">
                <!-- Face groups will be loaded here -->
            </div>
        </div>
    </div>

    <!-- Stories Modal -->
    <div id="stories-modal" class="modal hidden">
        <div class="modal-content large">
            <span class="close" id="close-stories-modal">&times;</span>
            <h2>üìö Stories</h2>
            <div class="stories-header">
                <button id="create-story-btn" class="primary-btn">+ Create New Story</button>
            </div>
            <div id="stories-list" class="stories-list">
                <!-- Stories will be loaded here -->
            </div>
        </div>
    </div>

    <!-- Create Story Modal -->
    <div id="create-story-modal" class="modal hidden">
        <div class="modal-content">
            <span class="close" id="close-create-story-modal">&times;</span>
            <h2>Create New Story</h2>
            <form id="create-story-form">
                <div class="form-group">
                    <label for="story-name">Story Name *</label>
                    <input type="text" id="story-name" required placeholder="Enter story name">
                </div>
                <div class="form-group">
                    <label for="story-description">Description</label>
                    <textarea id="story-description" rows="4" placeholder="Enter story description"></textarea>
                </div>
                <div class="modal-actions">
                    <button type="submit" class="primary-btn">Create Story</button>
                    <button type="button" id="cancel-create-story" class="secondary-btn">Cancel</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Add to Story Modal -->
    <div id="add-to-story-modal" class="modal hidden">
        <div class="modal-content">
            <span class="close" id="close-add-to-story-modal">&times;</span>
            <h2>Add to Story</h2>
            <div class="form-group">
                <label for="select-story">Select Story</label>
                <select id="select-story">
                    <option value="">Choose a story...</option>
                </select>
            </div>
            <div class="form-group">
                <label for="item-caption">Caption (optional)</label>
                <input type="text" id="item-caption" placeholder="Add a caption for this item">
            </div>
            <div class="modal-actions">
                <button id="confirm-add-to-story" class="primary-btn">Add to Story</button>
                <button id="cancel-add-to-story" class="secondary-btn">Cancel</button>
            </div>
        </div>
    </div>

    <!-- Story View Modal -->
    <div id="story-view-modal" class="modal hidden">
        <div class="modal-content large">
            <span class="close" id="close-story-view-modal">&times;</span>
            <div class="story-header">
                <h2 id="story-view-name"></h2>
                <p id="story-view-description"></p>
                <div class="story-actions">
                    <button id="edit-story-btn" class="action-btn">‚úèÔ∏è Edit</button>
                    <button id="delete-story-btn" class="action-btn danger">üóëÔ∏è Delete</button>
                </div>
            </div>
            <div id="story-items" class="story-items">
                <!-- Story items will be loaded here -->
            </div>
        </div>
    </div>

    <script src="app.js"></script>
</body>
</html>